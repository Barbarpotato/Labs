<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Performance Testing with k6</title><meta name="description" content="k6 is a command-line based tool specifically designed for load testing and performance testing. It allows you to simulate multiple users accessing your application, which helps identify potential issues when traffic spikes."/><meta property="og:title" content="Performance Testing with k6"/><meta property="og:description" content="k6 is a command-line based tool specifically designed for load testing and performance testing. It allows you to simulate multiple users accessing your application, which helps identify potential issues when traffic spikes."/><meta property="og:type" content="article"/><meta property="og:url" content="https://barbarpotato.github.io/labs/undefined"/><meta name="next-head-count" content="8"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Labs/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/Labs/_next/static/chunks/webpack-a39982bd6f80347b.js" defer=""></script><script src="/Labs/_next/static/chunks/framework-ecc4130bc7a58a64.js" defer=""></script><script src="/Labs/_next/static/chunks/main-1e09b50edce1e67f.js" defer=""></script><script src="/Labs/_next/static/chunks/pages/_app-753213cf38d40131.js" defer=""></script><script src="/Labs/_next/static/chunks/pages/labs/%5Bslug%5D-b6b888b0a2f30cff.js" defer=""></script><script src="/Labs/_next/static/A-n-baZxhaPab-FReiSSJ/_buildManifest.js" defer=""></script><script src="/Labs/_next/static/A-n-baZxhaPab-FReiSSJ/_ssgManifest.js" defer=""></script></head><body><div id="__next"><article><h1>Performance Testing with k6</h1><p>2024-09-20 11:34:02</p><div><div id="content-0"><h1>Understanding k6: A Load and Performance Testing Tool</h1><p>When developing an application, ensuring it can handle high traffic is crucial. This is where load testing and performance testing come into play, and <strong>k6</strong> is a powerful tool designed for this purpose. By using k6, you can assess whether your application can handle heavy traffic and perform optimally under various conditions.</p></div><div id="content-1"><h1>What is k6?</h1><p>k6 is a command-line based tool specifically designed for load testing and performance testing. It allows you to simulate multiple users accessing your application, which helps identify potential issues when traffic spikes.</p><h2><strong>Key Points About k6:</strong></h2><ul><li><strong>Terminal-Based:</strong> k6 operates directly through the terminal.</li><li><strong>JavaScript Testing:</strong> Tests are written in JavaScript, making it accessible for web developers.</li></ul><h2>What k6 Does Not Do</h2><p>While k6 is a robust tool, it has its limitations:</p><ul><li><strong>No Browser Interaction:</strong> k6 does not run through a browser.</li><li><strong>No Node.js Dependency:</strong> Unlike many JavaScript tools, k6 doesn't rely on Node.js but is built using Golang.</li><li><strong>No npm Modules Support:</strong> If you require additional modules, you can't install them via <code>npm install</code>. Instead, you must include the files directly in your project.</li></ul><h2>Limitations of k6</h2><p>k6 uses Golang's Goja library to execute JavaScript, which means it doesn’t support some of the features available in Node.js. This limitation requires a different approach when setting up your testing environment.</p></div><div id="content-2"><h2>Installation</h2><p>You can easily install k6 by following the instructions on their <a href="https://k6.io/docs/get-started/installation/" target="_blank">official installation page</a>.</p></div><div id="content-3"><h1>Initial Project Setup</h1><p>To get started with k6, you can set up a Node.js project:</p><ul><li>Initialize the project with <code>npm init</code> and set the type to <code>module</code>.</li><li>Install k6 as a module in your project.</li></ul><h2>k6 Library</h2><p>k6 comes with its own library that simplifies the process of creating tests. However, remember that the npm package for k6 doesn't contain actual JavaScript code—it’s mostly metadata. The k6 tool itself is built on Golang, so it doesn’t run on Node.js.</p></div><div id="content-4"><p>If you inspect the k6 module, you’ll find that it’s essentially an empty package with just a <code>package.json</code> format.</p><h3>Writing k6 Scripts</h3><p>Scripts in k6 are written in JavaScript and contain the code for the performance test along with the test scenarios you wish to execute. You can create a script manually or use a command to generate a basic script:</p></div><div id="content-5"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">k6 new src/ping.js
</code></pre></div><div id="content-6"><p>This command will create a new script at the specified location with a basic setup for performance testing.	</p></div><div id="content-7"><h3>Running a Script</h3><p>To execute the performance test, use the following command:</p></div><div id="content-8"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">k6 run lokasi/file.js
</code></pre></div><div id="content-10"><h1>Checking the code</h1></div><div id="content-11"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">import http from 'k6/http';
import { sleep } from 'k6';

export const options = {
  stages: [
    { duration: '10s', target: 10 },
    { duration: '20s', target: 30 },
    { duration: '30s', target: 50 },
    { duration: '10s', target: 0 }
  ]
  // // A number specifying the number of VUs to run concurrently.
  // vus: 10,
  // // A string specifying the total duration of the test run.
  // duration: '30s',

  const body = {
    name: "Darmawan"
  };
};

export default function () {

  http.post("https://httpbin.test.k6.io/post", JSON.stringify(body), {
    headers: {
      "Content-Type": "application/json",
      "Accept": "application/json"
    }
  })

  http.get('https://cerberry-backend.vercel.app/blogs/all');
  sleep(0.1);
}
</code></pre></div><div id="content-12"><p>we'll explore a simple yet effective k6 script designed to conduct load testing on an API. The script simulates multiple virtual users (VUs) interacting with the application, allowing us to observe how it performs under varying levels of traffic. To start, the script imports the necessary modules from k6—<code>http</code> for making HTTP requests and <code>sleep</code> to simulate user think time by pausing execution for a short duration.</p><p>The core of the script lies in the <code>options</code> object, where we define a series of stages that dictate how the load should be applied. The test begins by gradually ramping up to 10 virtual users over the first 10 seconds. It then continues to increase to 30 users over the next 20 seconds, and finally reaches 50 users over a 30-second period. After this peak, the number of users is gradually reduced back to zero over the last 10 seconds. This staged approach provides valuable insights into the scalability and robustness of the application as it experiences increasing and then decreasing traffic.</p><p>Within the <code>default</code> function, the script defines two key actions that each virtual user will perform. First, a POST request is made to <code>https://httpbin.test.k6.io/post</code>, sending a JSON payload with a name value of "Darmawan". This simulates a scenario where a user might submit data to the server, such as filling out a form. Immediately after, a GET request is sent to <code>https://cerberry-backend.vercel.app/blogs/all</code>, retrieving a list of blogs. This sequence mirrors typical user behavior in a web application, where data submission is often followed by data retrieval or refreshing content. To simulate a brief delay between these actions, the script includes a <code>sleep(0.1)</code> function, representing a short pause of 0.1 seconds.</p><p>To execute this script, you would simply run it using the k6 command in your terminal. This approach allows you to assess how well your application can handle varying levels of traffic, identify potential bottlenecks, and ensure that it remains performant under load. By gradually increasing and then decreasing the load, this script provides a comprehensive view of your application's performance, helping you make informed decisions about optimizations and improvements.</p></div><div id="content-13"><h2>Understanding the Summary Output</h2><p>After running a performance test, k6 generates a summary output that details the test results. By default, this output is displayed in the terminal, but you can also export it as a JSON file:</p></div><div id="content-14"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">k6 run file/script.js --summary-export output.json
</code></pre></div><div id="content-15"><p>You can find more information on the output metrics in the <a href="https://grafana.com/docs/k6/latest/using-k6/metrics/reference/" target="_blank">Grafana documentation</a>.</p></div><div id="content-16"><h2>Using the Web Dashboard</h2><p>k6 also offers a Web Dashboard for real-time monitoring of your tests. To enable this feature, you need to activate it through an environment variable. Detailed instructions are available in the <a href="https://grafana.com/docs/k6/latest/results-output/web-dashboard/" target="_blank">Web Dashboard documentation</a>.</p><h2>Using Stages for Dynamic Load Testing</h2><p>k6 provides a powerful feature called <strong>Stages</strong>, which allows you to increase or decrease the number of virtual users during the test. This is particularly useful for simulating different traffic patterns over time. You can learn more about this feature in the <a href="https://grafana.com/docs/k6/latest/using-k6/k6-options/reference/#stages" target="_blank">Stages documentation</a>.</p><p>By using k6 effectively, you can ensure your application is well-prepared to handle real-world traffic, preventing potential issues before they reach your users.</p></div></div></article></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"blog_id":"1fab12ad-ebb2-435c-9dc7-17e4015e9b95","description":"\u003cdiv id=\"content-0\"\u003e\u003ch1\u003eUnderstanding k6: A Load and Performance Testing Tool\u003c/h1\u003e\u003cp\u003eWhen developing an application, ensuring it can handle high traffic is crucial. This is where load testing and performance testing come into play, and \u003cstrong\u003ek6\u003c/strong\u003e is a powerful tool designed for this purpose. By using k6, you can assess whether your application can handle heavy traffic and perform optimally under various conditions.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-1\"\u003e\u003ch1\u003eWhat is k6?\u003c/h1\u003e\u003cp\u003ek6 is a command-line based tool specifically designed for load testing and performance testing. It allows you to simulate multiple users accessing your application, which helps identify potential issues when traffic spikes.\u003c/p\u003e\u003ch2\u003e\u003cstrong\u003eKey Points About k6:\u003c/strong\u003e\u003c/h2\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eTerminal-Based:\u003c/strong\u003e k6 operates directly through the terminal.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eJavaScript Testing:\u003c/strong\u003e Tests are written in JavaScript, making it accessible for web developers.\u003c/li\u003e\u003c/ul\u003e\u003ch2\u003eWhat k6 Does Not Do\u003c/h2\u003e\u003cp\u003eWhile k6 is a robust tool, it has its limitations:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eNo Browser Interaction:\u003c/strong\u003e k6 does not run through a browser.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eNo Node.js Dependency:\u003c/strong\u003e Unlike many JavaScript tools, k6 doesn't rely on Node.js but is built using Golang.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eNo npm Modules Support:\u003c/strong\u003e If you require additional modules, you can't install them via \u003ccode\u003enpm install\u003c/code\u003e. Instead, you must include the files directly in your project.\u003c/li\u003e\u003c/ul\u003e\u003ch2\u003eLimitations of k6\u003c/h2\u003e\u003cp\u003ek6 uses Golang's Goja library to execute JavaScript, which means it doesn’t support some of the features available in Node.js. This limitation requires a different approach when setting up your testing environment.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-2\"\u003e\u003ch2\u003eInstallation\u003c/h2\u003e\u003cp\u003eYou can easily install k6 by following the instructions on their \u003ca href=\"https://k6.io/docs/get-started/installation/\" target=\"_blank\"\u003eofficial installation page\u003c/a\u003e.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-3\"\u003e\u003ch1\u003eInitial Project Setup\u003c/h1\u003e\u003cp\u003eTo get started with k6, you can set up a Node.js project:\u003c/p\u003e\u003cul\u003e\u003cli\u003eInitialize the project with \u003ccode\u003enpm init\u003c/code\u003e and set the type to \u003ccode\u003emodule\u003c/code\u003e.\u003c/li\u003e\u003cli\u003eInstall k6 as a module in your project.\u003c/li\u003e\u003c/ul\u003e\u003ch2\u003ek6 Library\u003c/h2\u003e\u003cp\u003ek6 comes with its own library that simplifies the process of creating tests. However, remember that the npm package for k6 doesn't contain actual JavaScript code—it’s mostly metadata. The k6 tool itself is built on Golang, so it doesn’t run on Node.js.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-4\"\u003e\u003cp\u003eIf you inspect the k6 module, you’ll find that it’s essentially an empty package with just a \u003ccode\u003epackage.json\u003c/code\u003e format.\u003c/p\u003e\u003ch3\u003eWriting k6 Scripts\u003c/h3\u003e\u003cp\u003eScripts in k6 are written in JavaScript and contain the code for the performance test along with the test scenarios you wish to execute. You can create a script manually or use a command to generate a basic script:\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-5\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003ek6 new src/ping.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-6\"\u003e\u003cp\u003eThis command will create a new script at the specified location with a basic setup for performance testing.\t\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-7\"\u003e\u003ch3\u003eRunning a Script\u003c/h3\u003e\u003cp\u003eTo execute the performance test, use the following command:\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-8\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003ek6 run lokasi/file.js\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-10\"\u003e\u003ch1\u003eChecking the code\u003c/h1\u003e\u003c/div\u003e\u003cdiv id=\"content-11\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003eimport http from 'k6/http';\nimport { sleep } from 'k6';\n\nexport const options = {\n  stages: [\n    { duration: '10s', target: 10 },\n    { duration: '20s', target: 30 },\n    { duration: '30s', target: 50 },\n    { duration: '10s', target: 0 }\n  ]\n  // // A number specifying the number of VUs to run concurrently.\n  // vus: 10,\n  // // A string specifying the total duration of the test run.\n  // duration: '30s',\n\n  const body = {\n    name: \"Darmawan\"\n  };\n};\n\nexport default function () {\n\n  http.post(\"https://httpbin.test.k6.io/post\", JSON.stringify(body), {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"Accept\": \"application/json\"\n    }\n  })\n\n  http.get('https://cerberry-backend.vercel.app/blogs/all');\n  sleep(0.1);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-12\"\u003e\u003cp\u003ewe'll explore a simple yet effective k6 script designed to conduct load testing on an API. The script simulates multiple virtual users (VUs) interacting with the application, allowing us to observe how it performs under varying levels of traffic. To start, the script imports the necessary modules from k6—\u003ccode\u003ehttp\u003c/code\u003e for making HTTP requests and \u003ccode\u003esleep\u003c/code\u003e to simulate user think time by pausing execution for a short duration.\u003c/p\u003e\u003cp\u003eThe core of the script lies in the \u003ccode\u003eoptions\u003c/code\u003e object, where we define a series of stages that dictate how the load should be applied. The test begins by gradually ramping up to 10 virtual users over the first 10 seconds. It then continues to increase to 30 users over the next 20 seconds, and finally reaches 50 users over a 30-second period. After this peak, the number of users is gradually reduced back to zero over the last 10 seconds. This staged approach provides valuable insights into the scalability and robustness of the application as it experiences increasing and then decreasing traffic.\u003c/p\u003e\u003cp\u003eWithin the \u003ccode\u003edefault\u003c/code\u003e function, the script defines two key actions that each virtual user will perform. First, a POST request is made to \u003ccode\u003ehttps://httpbin.test.k6.io/post\u003c/code\u003e, sending a JSON payload with a name value of \"Darmawan\". This simulates a scenario where a user might submit data to the server, such as filling out a form. Immediately after, a GET request is sent to \u003ccode\u003ehttps://cerberry-backend.vercel.app/blogs/all\u003c/code\u003e, retrieving a list of blogs. This sequence mirrors typical user behavior in a web application, where data submission is often followed by data retrieval or refreshing content. To simulate a brief delay between these actions, the script includes a \u003ccode\u003esleep(0.1)\u003c/code\u003e function, representing a short pause of 0.1 seconds.\u003c/p\u003e\u003cp\u003eTo execute this script, you would simply run it using the k6 command in your terminal. This approach allows you to assess how well your application can handle varying levels of traffic, identify potential bottlenecks, and ensure that it remains performant under load. By gradually increasing and then decreasing the load, this script provides a comprehensive view of your application's performance, helping you make informed decisions about optimizations and improvements.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-13\"\u003e\u003ch2\u003eUnderstanding the Summary Output\u003c/h2\u003e\u003cp\u003eAfter running a performance test, k6 generates a summary output that details the test results. By default, this output is displayed in the terminal, but you can also export it as a JSON file:\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-14\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003ek6 run file/script.js --summary-export output.json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-15\"\u003e\u003cp\u003eYou can find more information on the output metrics in the \u003ca href=\"https://grafana.com/docs/k6/latest/using-k6/metrics/reference/\" target=\"_blank\"\u003eGrafana documentation\u003c/a\u003e.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-16\"\u003e\u003ch2\u003eUsing the Web Dashboard\u003c/h2\u003e\u003cp\u003ek6 also offers a Web Dashboard for real-time monitoring of your tests. To enable this feature, you need to activate it through an environment variable. Detailed instructions are available in the \u003ca href=\"https://grafana.com/docs/k6/latest/results-output/web-dashboard/\" target=\"_blank\"\u003eWeb Dashboard documentation\u003c/a\u003e.\u003c/p\u003e\u003ch2\u003eUsing Stages for Dynamic Load Testing\u003c/h2\u003e\u003cp\u003ek6 provides a powerful feature called \u003cstrong\u003eStages\u003c/strong\u003e, which allows you to increase or decrease the number of virtual users during the test. This is particularly useful for simulating different traffic patterns over time. You can learn more about this feature in the \u003ca href=\"https://grafana.com/docs/k6/latest/using-k6/k6-options/reference/#stages\" target=\"_blank\"\u003eStages documentation\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eBy using k6 effectively, you can ensure your application is well-prepared to handle real-world traffic, preventing potential issues before they reach your users.\u003c/p\u003e\u003c/div\u003e","image":"https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fk6.png?alt=media\u0026token=ee045685-94ba-421d-a189-aeb94cd7aa8c","image_alt":"k6 - performance testing","short_description":"k6 is a command-line based tool specifically designed for load testing and performance testing. It allows you to simulate multiple users accessing your application, which helps identify potential issues when traffic spikes.","timestamp":"2024-09-20 11:34:02","title":"Performance Testing with k6"}},"__N_SSG":true},"page":"/labs/[slug]","query":{"slug":"1fab12ad-ebb2-435c-9dc7-17e4015e9b95"},"buildId":"A-n-baZxhaPab-FReiSSJ","assetPrefix":"/Labs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>