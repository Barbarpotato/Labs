<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>ETL using shell scripts</title><meta name="description" content="In this lab, we perform ETL (Extract, Transform, Load) using shell scripts. Learn to extract data from delimited files, transform text data with cut and tr, and load it into a PostgreSQL database. This hands-on approach will gain essential skills for automating data management and integration."/><meta property="og:title" content="ETL using shell scripts"/><meta property="og:description" content="In this lab, we perform ETL (Extract, Transform, Load) using shell scripts. Learn to extract data from delimited files, transform text data with cut and tr, and load it into a PostgreSQL database. This hands-on approach will gain essential skills for automating data management and integration."/><meta property="og:type" content="article"/><meta property="og:url" content="https://barbarpotato.github.io/labs/undefined"/><meta name="next-head-count" content="8"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Labs/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/Labs/_next/static/chunks/webpack-a39982bd6f80347b.js" defer=""></script><script src="/Labs/_next/static/chunks/framework-ecc4130bc7a58a64.js" defer=""></script><script src="/Labs/_next/static/chunks/main-1e09b50edce1e67f.js" defer=""></script><script src="/Labs/_next/static/chunks/pages/_app-753213cf38d40131.js" defer=""></script><script src="/Labs/_next/static/chunks/pages/labs/%5Bslug%5D-b6b888b0a2f30cff.js" defer=""></script><script src="/Labs/_next/static/A-n-baZxhaPab-FReiSSJ/_buildManifest.js" defer=""></script><script src="/Labs/_next/static/A-n-baZxhaPab-FReiSSJ/_ssgManifest.js" defer=""></script></head><body><div id="__next"><article><h1>ETL using shell scripts</h1><p>2024-09-20 11:36:39</p><div><div id="content-0"><h1>What is ETL?</h1><p><strong>ETL</strong> stands for <strong>Extract, Transform, Load</strong>. It is a crucial process in data management and integration, typically used in data warehousing and data analytics. Here's a brief overview:</p><ul><li><strong>Extract</strong>:</li><li class="ql-indent-1">This step involves retrieving data from various sources such as databases, files, APIs, or other systems. The goal is to gather raw data for further processing.</li><li><strong>Transform</strong>:</li><li class="ql-indent-1">Once the data is extracted, it often needs to be cleaned, formatted, and transformed to fit the desired structure or schema. This step may include filtering, sorting, aggregating, and converting data to ensure consistency and compatibility.</li><li><strong>Load</strong>:</li><li class="ql-indent-1">The final step is to load the transformed data into a target system, such as a database, data warehouse, or data lake. This makes the data available for querying, analysis, and reporting.</li></ul><p><br></p><h1>ETL using Shell Scripts</h1><p>In this lab we will covering about read and extract data from various delimited thing using shell command. We'll understand how to handle file input, parse the data, and prepare it for further processing. Master the techniques for transforming text data using powerful shell utilities like tr command. and finally load the data to the database. in this lab we will use PostgreSQL. </p></div><div id="content-1"><h1><strong>Exercise 1 - Extracting data using 'cut' command</strong></h1><h2>Extracting characters</h2><p></p></div><div id="content-2"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">echo "database" | cut -c1-4</code></pre></div><div id="content-4"><p>You should get the string ‘data’ as output.</p><p>The command below shows how to extract 5th to 8th characters.</p></div><div id="content-5"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">echo "database" | cut -c5-8</code></pre></div><div id="content-6"><p>You should get the string ‘base’ as output.</p><p>Non-contiguous characters can be extracted using the comma.</p></div><div id="content-7"><h2>Extracting fields/columns</h2><p>We can extract a specific column/field from a delimited text file, by mentioning</p><ul><li>the delimiter using the&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">-d</code>&nbsp;option, or</li><li>the field number using the&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">-f</code>&nbsp;option.</li></ul><p>The /etc/passwd is a “:” delimited file.</p><p>The command below extracts usernames (the first field) from /etc/passwd.</p></div><div id="content-8"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">cut -d":" -f1 /etc/passwd</code></pre></div><div id="content-9"><p></p></div><div id="content-10"><img  style='width:600px; height:100%'src='https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fetl_using_shell_script_img_1.png?alt=media&token=7a3e427e-002d-4d12-875f-8f8160cc984d'/></div><div id="content-11"><h1><strong>Exercise 2 - Transforming data using 'tr'</strong></h1></div><div id="content-12"><h2>Translate from one character set to another</h2><p>The command below translates all lower case alphabets to upper case.</p></div><div id="content-13"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">echo "Shell Scripting" | tr "[a-z]" "[A-Z]" echo "Shell Scripting" | tr "[:lower:]" "[:upper:]" echo "Shell Scripting" | tr "[A-Z]" "[a-z]"</code></pre></div><div id="content-14"><h1>Prepared the Database for the practice</h1><p>In this exercise we will create a table called&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">users</code>&nbsp;in the PostgreSQL database using PostgresSQL CLI. This table will hold the user account information.</p><p>The table&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">users</code>&nbsp;will have the following columns: uname, uid, home</p></div><div id="content-15"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">create table users(username varchar(50),userid int,homedirectory varchar(100));</code></pre></div><div id="content-17"><h1>Create the Shell Script File</h1>touch csv2db.sh. Then Open the file in the editor. Copy and paste the following lines into the newly created file.</p></div><div id="content-18"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;"># This script # Extracts data from /etc/passwd file into a CSV file. # The csv data file contains the user name, user id and # home directory of each user account defined in /etc/passwd # Transforms the text delimiter from ":" to ",". # Loads the data from the CSV file into a table in PostgreSQL database.</code></pre></div><div id="content-19"><p>We need to add lines of code to the script that will xtract user name (field 1), user id (field 3), and home directory path (field 6) from /etc/passwd file using the&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">cut</code>&nbsp;command. </p></div><div id="content-20"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">cut -d":" -f1,3,6 /etc/passwd</code></pre></div><div id="content-21"><p>then run the script. -&gt; bash csv2db.sh</p></div><div id="content-22"><p>let us change the last line of command so it not directly printed trough the terminal instead we will save the output to .txt file</p></div><div id="content-23"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">cut -d":" -f1,3,6 /etc/passwd &gt; extracted-data.txt</code></pre></div><div id="content-24"><img style='width:720px; heigth:100%;' src='https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fetl_using_shell_script_img_2.png?alt=media&token=3b31b28f-40bf-4f3e-952a-4d0607d133c6'/></div><div id="content-25"><p>The extracted columns are separated by the original “:” delimiter. You need to convert this into a “,” delimited file. Add the below lines at the end of the script and save the file.</p></div><div id="content-26"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">tr ":" "," &lt; extracted-data.txt &gt; transformed-data.csv</code></pre></div><div id="content-27"><p>Run the script and then it automatically save the .csv file to your system. you can read it from the terimnal by calling this command: cat transformed-data.csv</p></div><div id="content-29"><h3>To load data from a shell script, you will use the&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">psql</code>&nbsp;client utility in a non-interactive manner. This is done by sending the database commands through a command pipeline to&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">psql</code>&nbsp;with the help of&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">echo</code>&nbsp;command.</h3><p><br></p></div><div id="content-30"><p>PostgreSQL command to copy data from a CSV file to a table is&nbsp;<code style="background-color: transparent; color: rgb(255, 153, 0);">COPY</code>.</p><p>The basic structure of the command which we will use in our script is</p></div><div id="content-31"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">COPY table_name FROM 'filename' DELIMITERS 'delimiter_character' FORMAT;</code></pre></div><div id="content-32"><p></p></div><div id="content-33"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">echo "\c template1;\COPY users FROM '/home/project/transformed-data.csv' DELIMITERS ',' CSV;" | psql --username=postgres --host=localhost</code></pre></div><div id="content-34"><pre style="background-color: black; color: white; padding:10px; border-radius: 5px;"><code style="color: white;">echo '\c template1; \\SELECT * from users;' | psql --username=postgres --host=localhost</code></pre></div><div id="content-35"><img style='width:720px; height:100%;' src='https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fetl_using_shell_script_img_3.png?alt=media&token=ff23b79e-4971-4f41-9060-58b47f009358'/></div></div></article></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"blog_id":"c4973cc3-3c29-4fcb-9651-5d921b02eed2","description":"\u003cdiv id=\"content-0\"\u003e\u003ch1\u003eWhat is ETL?\u003c/h1\u003e\u003cp\u003e\u003cstrong\u003eETL\u003c/strong\u003e stands for \u003cstrong\u003eExtract, Transform, Load\u003c/strong\u003e. It is a crucial process in data management and integration, typically used in data warehousing and data analytics. Here's a brief overview:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cstrong\u003eExtract\u003c/strong\u003e:\u003c/li\u003e\u003cli class=\"ql-indent-1\"\u003eThis step involves retrieving data from various sources such as databases, files, APIs, or other systems. The goal is to gather raw data for further processing.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eTransform\u003c/strong\u003e:\u003c/li\u003e\u003cli class=\"ql-indent-1\"\u003eOnce the data is extracted, it often needs to be cleaned, formatted, and transformed to fit the desired structure or schema. This step may include filtering, sorting, aggregating, and converting data to ensure consistency and compatibility.\u003c/li\u003e\u003cli\u003e\u003cstrong\u003eLoad\u003c/strong\u003e:\u003c/li\u003e\u003cli class=\"ql-indent-1\"\u003eThe final step is to load the transformed data into a target system, such as a database, data warehouse, or data lake. This makes the data available for querying, analysis, and reporting.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\u003ch1\u003eETL using Shell Scripts\u003c/h1\u003e\u003cp\u003eIn this lab we will covering about read and extract data from various delimited thing using shell command. We'll understand how to handle file input, parse the data, and prepare it for further processing. Master the techniques for transforming text data using powerful shell utilities like tr command. and finally load the data to the database. in this lab we will use PostgreSQL. \u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-1\"\u003e\u003ch1\u003e\u003cstrong\u003eExercise 1 - Extracting data using 'cut' command\u003c/strong\u003e\u003c/h1\u003e\u003ch2\u003eExtracting characters\u003c/h2\u003e\u003cp\u003e\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-2\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003eecho \"database\" | cut -c1-4\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-4\"\u003e\u003cp\u003eYou should get the string ‘data’ as output.\u003c/p\u003e\u003cp\u003eThe command below shows how to extract 5th to 8th characters.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-5\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003eecho \"database\" | cut -c5-8\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-6\"\u003e\u003cp\u003eYou should get the string ‘base’ as output.\u003c/p\u003e\u003cp\u003eNon-contiguous characters can be extracted using the comma.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-7\"\u003e\u003ch2\u003eExtracting fields/columns\u003c/h2\u003e\u003cp\u003eWe can extract a specific column/field from a delimited text file, by mentioning\u003c/p\u003e\u003cul\u003e\u003cli\u003ethe delimiter using the\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003e-d\u003c/code\u003e\u0026nbsp;option, or\u003c/li\u003e\u003cli\u003ethe field number using the\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003e-f\u003c/code\u003e\u0026nbsp;option.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe /etc/passwd is a “:” delimited file.\u003c/p\u003e\u003cp\u003eThe command below extracts usernames (the first field) from /etc/passwd.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-8\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003ecut -d\":\" -f1 /etc/passwd\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-9\"\u003e\u003cp\u003e\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-10\"\u003e\u003cimg  style='width:600px; height:100%'src='https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fetl_using_shell_script_img_1.png?alt=media\u0026token=7a3e427e-002d-4d12-875f-8f8160cc984d'/\u003e\u003c/div\u003e\u003cdiv id=\"content-11\"\u003e\u003ch1\u003e\u003cstrong\u003eExercise 2 - Transforming data using 'tr'\u003c/strong\u003e\u003c/h1\u003e\u003c/div\u003e\u003cdiv id=\"content-12\"\u003e\u003ch2\u003eTranslate from one character set to another\u003c/h2\u003e\u003cp\u003eThe command below translates all lower case alphabets to upper case.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-13\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003eecho \"Shell Scripting\" | tr \"[a-z]\" \"[A-Z]\" echo \"Shell Scripting\" | tr \"[:lower:]\" \"[:upper:]\" echo \"Shell Scripting\" | tr \"[A-Z]\" \"[a-z]\"\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-14\"\u003e\u003ch1\u003ePrepared the Database for the practice\u003c/h1\u003e\u003cp\u003eIn this exercise we will create a table called\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003eusers\u003c/code\u003e\u0026nbsp;in the PostgreSQL database using PostgresSQL CLI. This table will hold the user account information.\u003c/p\u003e\u003cp\u003eThe table\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003eusers\u003c/code\u003e\u0026nbsp;will have the following columns: uname, uid, home\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-15\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003ecreate table users(username varchar(50),userid int,homedirectory varchar(100));\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-17\"\u003e\u003ch1\u003eCreate the Shell Script File\u003c/h1\u003etouch csv2db.sh. Then Open the file in the editor. Copy and paste the following lines into the newly created file.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-18\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003e# This script # Extracts data from /etc/passwd file into a CSV file. # The csv data file contains the user name, user id and # home directory of each user account defined in /etc/passwd # Transforms the text delimiter from \":\" to \",\". # Loads the data from the CSV file into a table in PostgreSQL database.\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-19\"\u003e\u003cp\u003eWe need to add lines of code to the script that will xtract user name (field 1), user id (field 3), and home directory path (field 6) from /etc/passwd file using the\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003ecut\u003c/code\u003e\u0026nbsp;command. \u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-20\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003ecut -d\":\" -f1,3,6 /etc/passwd\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-21\"\u003e\u003cp\u003ethen run the script. -\u0026gt; bash csv2db.sh\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-22\"\u003e\u003cp\u003elet us change the last line of command so it not directly printed trough the terminal instead we will save the output to .txt file\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-23\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003ecut -d\":\" -f1,3,6 /etc/passwd \u0026gt; extracted-data.txt\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-24\"\u003e\u003cimg style='width:720px; heigth:100%;' src='https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fetl_using_shell_script_img_2.png?alt=media\u0026token=3b31b28f-40bf-4f3e-952a-4d0607d133c6'/\u003e\u003c/div\u003e\u003cdiv id=\"content-25\"\u003e\u003cp\u003eThe extracted columns are separated by the original “:” delimiter. You need to convert this into a “,” delimited file. Add the below lines at the end of the script and save the file.\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-26\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003etr \":\" \",\" \u0026lt; extracted-data.txt \u0026gt; transformed-data.csv\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-27\"\u003e\u003cp\u003eRun the script and then it automatically save the .csv file to your system. you can read it from the terimnal by calling this command: cat transformed-data.csv\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-29\"\u003e\u003ch3\u003eTo load data from a shell script, you will use the\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003epsql\u003c/code\u003e\u0026nbsp;client utility in a non-interactive manner. This is done by sending the database commands through a command pipeline to\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003epsql\u003c/code\u003e\u0026nbsp;with the help of\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003eecho\u003c/code\u003e\u0026nbsp;command.\u003c/h3\u003e\u003cp\u003e\u003cbr\u003e\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-30\"\u003e\u003cp\u003ePostgreSQL command to copy data from a CSV file to a table is\u0026nbsp;\u003ccode style=\"background-color: transparent; color: rgb(255, 153, 0);\"\u003eCOPY\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eThe basic structure of the command which we will use in our script is\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-31\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003eCOPY table_name FROM 'filename' DELIMITERS 'delimiter_character' FORMAT;\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-32\"\u003e\u003cp\u003e\u003c/p\u003e\u003c/div\u003e\u003cdiv id=\"content-33\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003eecho \"\\c template1;\\COPY users FROM '/home/project/transformed-data.csv' DELIMITERS ',' CSV;\" | psql --username=postgres --host=localhost\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-34\"\u003e\u003cpre style=\"background-color: black; color: white; padding:10px; border-radius: 5px;\"\u003e\u003ccode style=\"color: white;\"\u003eecho '\\c template1; \\\\SELECT * from users;' | psql --username=postgres --host=localhost\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv id=\"content-35\"\u003e\u003cimg style='width:720px; height:100%;' src='https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fetl_using_shell_script_img_3.png?alt=media\u0026token=ff23b79e-4971-4f41-9060-58b47f009358'/\u003e\u003c/div\u003e","image":"https://firebasestorage.googleapis.com/v0/b/personal-blog-darmajr.appspot.com/o/blog-content%2Fetl_using_shell_scripts.png?alt=media\u0026token=e81bec9a-d988-429f-954c-eab34e3d0e11","image_alt":"ETL Using bash Script","short_description":"In this lab, we perform ETL (Extract, Transform, Load) using shell scripts. Learn to extract data from delimited files, transform text data with cut and tr, and load it into a PostgreSQL database. This hands-on approach will gain essential skills for automating data management and integration.","timestamp":"2024-09-20 11:36:39","title":"ETL using shell scripts"}},"__N_SSG":true},"page":"/labs/[slug]","query":{"slug":"c4973cc3-3c29-4fcb-9651-5d921b02eed2"},"buildId":"A-n-baZxhaPab-FReiSSJ","assetPrefix":"/Labs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>